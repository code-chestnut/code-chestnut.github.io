---
title: "Dashboard"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)
library(plotly)
library(p8105.datasets)
library(dplyr)
```

```{r}
data("ny_noaa")

clean_ny = ny_noaa %>% 
  janitor::clean_names() %>% 
  mutate(
    year = lubridate::year(date),
    month = lubridate::month(date, label = TRUE),
    prcp = as.numeric(prcp) / 10, 
    tmax = as.numeric(tmax) / 10,
    tmin = as.numeric(tmin) / 10
  )%>% 
filter(
    date >= as.Date("2008-01-01") & date <= as.Date("2008-12-31"))
```
Column {data-width=550}
-----------------------------------------------------------------------

### Chart A
```{r}
plot_ly(
  data = clean_ny,
  x = ~month,
  y = ~tmax,
  type = 'box',
  boxpoints = 'outliers',
  color = ~month, 
  colors = "viridis",
  marker = list(size = 4)
) %>%
  layout(
    title = "Monthly Distribution of Maximum Temperature in New York (2008)",
    xaxis = list(title = "Month"),
    yaxis = list(title = "Max Temperature (Â°C)")
  )

```
Column {data-width=450}
-----------------------------------------------------------------------

### Chart B
```{r}
monthly_pre = clean_ny %>% 
  filter(!is.na(prcp)) %>% 
  group_by(month) %>% 
  summarise(total_prcp = sum(prcp, na.rm = TRUE))

# Create bar plot using plotly
plot_ly(
  data = monthly_pre,
  x = ~month,
  y = ~total_prcp,
  type = 'bar',
  color = ~month,
  colors = "viridis"
) %>%
  layout(
    title = "Total Monthly Precipitation in New York (2008)",
    xaxis = list(title = "Month"),
    yaxis = list(title = "Total Precipitation (mm)"),
    showlegend = FALSE
  )
```

### Chart C
```{r}
pie_data <- instacart_sample %>% 
  group_by(aisle) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count)) %>% 
  top_n(10)

pie_chart <- plot_ly(pie_data, labels = ~aisle, values = ~count, type = 'pie') %>%
  layout(title = "Proportion of Products Ordered by Top 10 Aisles")
pie_chart
```
